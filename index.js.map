{"version":3,"file":"index.js","sources":["../node_modules/navaid/dist/navaid.mjs","../node_modules/regexparam/dist/regexparam.mjs","../src/components/Nav.svelte","../src/components/App.svelte","../src/index.js"],"sourcesContent":["import convert from 'regexparam';\n\nexport default function Navaid(base, on404) {\n\tvar rgx, routes=[], $={};\n\n\tvar fmt = $.format = function (uri) {\n\t\tif (!uri) return uri;\n\t\turi = '/' + uri.replace(/^\\/|\\/$/g, '');\n\t\treturn rgx.test(uri) && uri.replace(rgx, '/');\n\t}\n\n\tbase = '/' + (base || '').replace(/^\\/|\\/$/g, '');\n\trgx = base == '/' ? /^\\/+/ : new RegExp('^\\\\' + base + '(?=\\\\/|$)\\\\/?', 'i');\n\n\t$.route = function (uri, replace) {\n\t\tif (uri[0] == '/' && !rgx.test(uri)) uri = base + uri;\n\t\thistory[(replace ? 'replace' : 'push') + 'State'](uri, null, uri);\n\t}\n\n\t$.on = function (pat, fn) {\n\t\t(pat = convert(pat)).fn = fn;\n\t\troutes.push(pat);\n\t\treturn $;\n\t}\n\n\t$.run = function (uri) {\n\t\tvar i=0, params={}, arr, obj;\n\t\tif (uri = fmt(uri || location.pathname)) {\n\t\t\turi = uri.match(/[^\\?#]*/)[0];\n\t\t\tfor (; i < routes.length; i++) {\n\t\t\t\tif (arr = (obj=routes[i]).pattern.exec(uri)) {\n\t\t\t\t\tfor (i=0; i < obj.keys.length;) {\n\t\t\t\t\t\tparams[obj.keys[i]] = arr[++i] || null;\n\t\t\t\t\t}\n\t\t\t\t\tobj.fn(params); // todo loop?\n\t\t\t\t\treturn $;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (on404) on404(uri);\n\t\t}\n\t\treturn $;\n\t}\n\n\t$.listen = function () {\n\t\twrap('push');\n\t\twrap('replace');\n\n\t\tfunction run(e) {\n\t\t\t$.run();\n\t\t}\n\n\t\tfunction click(e) {\n\t\t\tvar x = e.target.closest('a'), y = x && x.getAttribute('href');\n\t\t\tif (e.ctrlKey || e.metaKey || e.altKey || e.shiftKey || e.button || e.defaultPrevented) return;\n\t\t\tif (!y || x.target || x.host !== location.host) return;\n\t\t\tif (y[0] != '/' || rgx.test(y)) {\n\t\t\t\te.preventDefault();\n\t\t\t\t$.route(y);\n\t\t\t}\n\t\t}\n\n\t\taddEventListener('popstate', run);\n\t\taddEventListener('replacestate', run);\n\t\taddEventListener('pushstate', run);\n\t\taddEventListener('click', click);\n\n\t\t$.unlisten = function () {\n\t\t\tremoveEventListener('popstate', run);\n\t\t\tremoveEventListener('replacestate', run);\n\t\t\tremoveEventListener('pushstate', run);\n\t\t\tremoveEventListener('click', click);\n\t\t}\n\n\t\treturn $.run();\n\t}\n\n\treturn $;\n}\n\nfunction wrap(type, fn) {\n\tif (history[type]) return;\n\thistory[type] = type;\n\tfn = history[type += 'State'];\n\thistory[type] = function (uri) {\n\t\tvar ev = new Event(type.toLowerCase());\n\t\tev.uri = uri;\n\t\tfn.apply(this, arguments);\n\t\treturn dispatchEvent(ev);\n\t}\n}\n","export default function (str, loose) {\n\tif (str instanceof RegExp) return { keys:false, pattern:str };\n\tvar c, o, tmp, ext, keys=[], pattern='', arr = str.split('/');\n\tarr[0] || arr.shift();\n\n\twhile (tmp = arr.shift()) {\n\t\tc = tmp[0];\n\t\tif (c === '*') {\n\t\t\tkeys.push('wild');\n\t\t\tpattern += '/(.*)';\n\t\t} else if (c === ':') {\n\t\t\to = tmp.indexOf('?', 1);\n\t\t\text = tmp.indexOf('.', 1);\n\t\t\tkeys.push( tmp.substring(1, !!~o ? o : !!~ext ? ext : tmp.length) );\n\t\t\tpattern += !!~o && !~ext ? '(?:/([^/]+?))?' : '/([^/]+?)';\n\t\t\tif (!!~ext) pattern += (!!~o ? '?' : '') + '\\\\' + tmp.substring(ext);\n\t\t} else {\n\t\t\tpattern += '/' + tmp;\n\t\t}\n\t}\n\n\treturn {\n\t\tkeys: keys,\n\t\tpattern: new RegExp('^' + pattern + (loose ? '(?=$|\\/)' : '\\/?$'), 'i')\n\t};\n}\n","<nav>\n\t<ul>\n\t\t<li><a class=\"{ isActive('home') }\" href=\"/\">home</a></li>\n\t\t<li><a class=\"{ isActive('about') }\" href=\"/about\">about</a></li>\n\t\t<li><a class=\"{ isActive('blog') }\" href=\"/blog\">blog</a></li>\n\t</ul>\n</nav>\n\n<script>\n\texport let active;\n\t$: isActive = str => active === str ? 'selected' : '';\n</script>\n\n<style>\n\tnav {\n\t\tborder-bottom: 1px solid rgba(170,30,30,0.1);\n\t\tfont-weight: 300;\n\t\tpadding: 0 1em;\n\t}\n\tul {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t}\n\t/* clearfix */\n\tul::after {\n\t\tcontent: '';\n\t\tdisplay: block;\n\t\tclear: both;\n\t}\n\tli {\n\t\tdisplay: block;\n\t\tfloat: left;\n\t}\n\t.selected {\n\t\tposition: relative;\n\t\tdisplay: inline-block;\n\t}\n\t.selected::after {\n\t\tposition: absolute;\n\t\tcontent: '';\n\t\twidth: calc(100% - 1em);\n\t\theight: 2px;\n\t\tbackground-color: rgb(170,30,30);\n\t\tdisplay: block;\n\t\tbottom: -1px;\n\t}\n\ta {\n\t\ttext-decoration: none;\n\t\tpadding: 1em 0.5em;\n\t\tdisplay: block;\n\t}\n</style>\n","<Nav {active} />\n\n<main>\n\t<svelte:component this={Route} {params} />\n</main>\n\n<script>\n\timport Navaid from 'navaid';\n\timport { onDestroy } from 'svelte';\n\timport Nav from './Nav.svelte';\n\n\tlet Route, params, active;\n\tlet uri = location.pathname;\n\t$: active = uri.split('/')[1] || 'home';\n\n\tfunction draw(m, obj) {\n\t\tparams = obj || {};\n\t\tif (m.preload) {\n\t\t\tm.preload({ params }).then(() => {\n\t\t\t\tRoute = m.default;\n\t\t\t});\n\t\t} else {\n\t\t\tRoute = m.default;\n\t\t}\n\t}\n\n\tfunction track(obj) {\n\t\turi = obj.state || obj.uri;\n\t\tif (window.ga) ga.send('pageview', { dp:uri });\n\t}\n\n\taddEventListener('replacestate', track);\n\taddEventListener('pushstate', track);\n\taddEventListener('popstate', track);\n\n\tconst router = Navaid('/')\n\t\t.on('/', () => import('../routes/Home.svelte').then(draw))\n\t\t.on('/about', () => import('../routes/About.svelte').then(draw))\n\t\t.on('/blog', () => import('../routes/Blog.svelte').then(draw))\n\t\t.on('/blog/:postid', obj => import('../routes/Article.svelte').then(m => draw(m, obj)))\n\t\t.listen();\n\n\tonDestroy(router.unlisten);\n</script>\n\n<style>\n\tmain {\n\t\tposition: relative;\n\t\tmax-width: 56em;\n\t\tbackground-color: white;\n\t\tpadding: 2em;\n\t\tmargin: 0 auto;\n\t\tbox-sizing: border-box;\n\t}\n</style>\n","import App from './components/App.svelte';\n\nconst app = new App({\n\ttarget: document.body\n});\n\nexport default app;\n"],"names":["Navaid","base","on404","rgx","routes","$","fmt","format","uri","replace","test","RegExp","route","history","on","pat","fn","str","loose","keys","pattern","c","o","tmp","ext","arr","split","shift","push","indexOf","substring","length","convert","run","obj","i","params","location","pathname","match","exec","listen","e","click","x","target","closest","y","getAttribute","ctrlKey","metaKey","altKey","shiftKey","button","defaultPrevented","host","preventDefault","wrap","addEventListener","unlisten","removeEventListener","type","ev","Event","toLowerCase","apply","this","arguments","dispatchEvent","isActive","active","Route","draw","m","preload","then","default","track","state","window","ga","send","dp","router","import","onDestroy","document","body"],"mappings":"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"}